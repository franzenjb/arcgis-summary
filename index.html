<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red Cross Emergency Operations Intelligence Platform</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0e1a;
            color: #ffffff;
            line-height: 1.3;
            overflow-x: hidden;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #990000 0%, #cc0000 100%);
            color: white;
            padding: 8px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            height: 50px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 28px;
            height: 28px;
            background: rgba(255,255,255,0.2);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
        }

        .header-title {
            font-size: 14px;
            font-weight: 600;
        }

        .header-subtitle {
            font-size: 9px;
            opacity: 0.85;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 9px;
            font-weight: 500;
        }

        .header-right div {
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 3px;
            transition: background 0.2s;
        }

        .header-right div:hover {
            background: rgba(255,255,255,0.1);
        }

        /* Navigation */
        .nav-container {
            background: #1a1f2e;
            border-bottom: 1px solid #2d3748;
            padding: 0 16px;
            height: 40px;
        }

        .nav-tabs {
            display: flex;
            gap: 0;
            height: 40px;
        }

        .nav-tab {
            padding: 0 16px;
            font-size: 11px;
            font-weight: 600;
            color: #a0aec0;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
        }

        .nav-tab.active {
            color: #ffffff;
            border-bottom-color: #990000;
            background: #2d3748;
        }

        .nav-tab:hover:not(.active) {
            color: #ffffff;
            background: #2d3748;
        }

        /* Main Content */
        .main-content {
            padding: 12px;
            height: calc(100vh - 90px);
            overflow-y: auto;
        }

        /* Summary Bar */
        .summary-bar {
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            border: 1px solid #4a5568;
            border-radius: 8px;
            padding: 12px 20px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            height: 60px;
        }

        .summary-item {
            text-align: center;
            flex: 1;
        }

        .summary-label {
            font-size: 9px;
            color: #a0aec0;
            margin-bottom: 3px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .summary-value {
            font-size: 14px;
            font-weight: 700;
            color: #ffffff;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 12px;
            margin-bottom: 12px;
        }

        /* Card */
        .card {
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            border: 1px solid #4a5568;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            transition: all 0.2s ease;
        }

        .card:hover {
            box-shadow: 0 4px 16px rgba(0,0,0,0.4);
            transform: translateY(-1px);
            border-color: #990000;
        }

        .card-header {
            padding: 8px 12px;
            border-bottom: 1px solid #4a5568;
            background: #2d3748;
            height: 32px;
            display: flex;
            align-items: center;
        }

        .card-title {
            font-size: 10px;
            font-weight: 600;
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .card-body {
            padding: 12px;
        }

        /* KPI Cards */
        .kpi-card {
            text-align: left;
        }

        .kpi-value {
            font-size: 20px;
            font-weight: 800;
            color: #ffffff;
            line-height: 1;
            margin-bottom: 4px;
        }

        .kpi-unit {
            font-size: 9px;
            color: #a0aec0;
            font-weight: 500;
        }

        .kpi-change {
            font-size: 8px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .kpi-change.positive { color: #48bb78; }
        .kpi-change.negative { color: #f56565; }
        .kpi-change.neutral { color: #a0aec0; }

        /* Charts */
        .chart-container {
            width: 100%;
            height: 180px;
            position: relative;
        }

        .chart-medium {
            grid-column: span 2;
        }

        .chart-large {
            grid-column: span 3;
        }

        .chart-large .chart-container {
            height: 240px;
        }

        .chart-full {
            grid-column: span 6;
        }

        .chart-full .chart-container {
            height: 200px;
        }

        .mini-chart {
            grid-column: span 1;
        }

        .mini-chart .chart-container {
            height: 120px;
        }

        /* Data Table */
        .table-container {
            max-height: 240px;
            overflow-y: auto;
            background: #1a202c;
            border-radius: 6px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            text-align: left;
            padding: 6px 8px;
            font-size: 8px;
            font-weight: 700;
            color: #a0aec0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: #2d3748;
            border-bottom: 1px solid #4a5568;
            position: sticky;
            top: 0;
        }

        .data-table td {
            padding: 6px 8px;
            font-size: 9px;
            border-bottom: 1px solid #4a5568;
            color: #e2e8f0;
        }

        .data-table tbody tr:hover {
            background: #2d3748;
        }

        /* Status Badge */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 3px;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 7px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .status-badge.complete {
            background: rgba(72, 187, 120, 0.2);
            color: #68d391;
            border: 1px solid #48bb78;
        }

        .status-badge.progress {
            background: rgba(245, 158, 11, 0.2);
            color: #fbbf24;
            border: 1px solid #f59e0b;
        }

        .status-badge.critical {
            background: rgba(245, 101, 101, 0.2);
            color: #fc8181;
            border: 1px solid #f56565;
        }

        /* Progress Bars */
        .progress-container {
            margin: 8px 0;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .progress-label-text {
            font-size: 8px;
            color: #a0aec0;
            font-weight: 500;
        }

        .progress-label-value {
            font-size: 8px;
            font-weight: 600;
            color: #ffffff;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #4a5568;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 1s ease;
        }

        .progress-fill.critical { background: linear-gradient(90deg, #f56565, #e53e3e); }
        .progress-fill.warning { background: linear-gradient(90deg, #ed8936, #dd6b20); }
        .progress-fill.success { background: linear-gradient(90deg, #48bb78, #38a169); }
        .progress-fill.info { background: linear-gradient(90deg, #4299e1, #3182ce); }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Filters */
        .filters {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
            align-items: center;
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #4a5568;
            height: 36px;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .filter-label {
            font-size: 8px;
            font-weight: 600;
            color: #a0aec0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-select {
            padding: 4px 8px;
            border: 1px solid #4a5568;
            border-radius: 4px;
            font-size: 9px;
            background: #2d3748;
            color: #ffffff;
            font-weight: 500;
        }

        .filter-actions {
            margin-left: auto;
            display: flex;
            gap: 6px;
        }

        .btn {
            padding: 4px 12px;
            border: 1px solid #4a5568;
            border-radius: 4px;
            font-size: 8px;
            font-weight: 600;
            background: #2d3748;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            background: #4a5568;
            border-color: #68d391;
        }

        .btn.primary {
            background: #990000;
            color: white;
            border-color: #990000;
        }

        .btn.primary:hover {
            background: #cc0000;
        }

        /* Live indicators */
        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 7px;
            font-weight: 600;
            color: #48bb78;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .live-dot {
            width: 4px;
            height: 4px;
            background: #48bb78;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Metrics Row */
        .metrics-row {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 8px;
            margin-bottom: 12px;
        }

        .metric-card {
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            border: 1px solid #4a5568;
            border-radius: 6px;
            padding: 8px;
            text-align: center;
            transition: all 0.2s ease;
        }

        .metric-card:hover {
            border-color: #990000;
            transform: translateY(-1px);
        }

        .metric-number {
            font-size: 16px;
            font-weight: 800;
            color: #ffffff;
            line-height: 1;
        }

        .metric-label {
            font-size: 7px;
            color: #a0aec0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 2px;
        }

        .metric-change {
            font-size: 6px;
            margin-top: 2px;
        }

        /* Activity Feed */
        .activity-feed {
            background: #1a202c;
            border-radius: 6px;
            padding: 8px;
            max-height: 200px;
            overflow-y: auto;
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 4px 0;
            border-bottom: 1px solid #2d3748;
            font-size: 8px;
        }

        .activity-time {
            color: #a0aec0;
            font-weight: 600;
            min-width: 40px;
        }

        .activity-text {
            color: #e2e8f0;
            flex: 1;
        }

        .activity-priority {
            padding: 1px 4px;
            border-radius: 3px;
            font-size: 6px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .activity-priority.high {
            background: rgba(245, 101, 101, 0.2);
            color: #fc8181;
        }

        .activity-priority.medium {
            background: rgba(245, 158, 11, 0.2);
            color: #fbbf24;
        }

        .activity-priority.low {
            background: rgba(72, 187, 120, 0.2);
            color: #68d391;
        }

        /* Responsive */
        @media (max-width: 1400px) {
            .dashboard-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            .chart-large {
                grid-column: span 2;
            }
            .chart-full {
                grid-column: span 4;
            }
        }

        @media (max-width: 1000px) {
            .dashboard-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            .chart-large {
                grid-column: span 2;
            }
            .chart-full {
                grid-column: span 3;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="logo-icon">✚</div>
            <div>
                <div class="header-title">EMERGENCY OPERATIONS INTELLIGENCE PLATFORM</div>
                <div class="header-subtitle">Version 3.2 | Missouri & Arkansas Storm Response | REAL-TIME</div>
            </div>
        </div>
        <div class="header-right">
            <div>ALERTS: <span id="alertCount">23</span></div>
            <div>TEAMS: 45</div>
            <div>STATUS: ACTIVE</div>
            <div>USER: OPS-CHIEF</div>
            <div>LOG OFF</div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav-container">
        <div class="nav-tabs">
            <div class="nav-tab active" data-tab="overview">OPERATIONAL OVERVIEW</div>
            <div class="nav-tab" data-tab="assessments">PROPERTY ASSESSMENTS</div>
            <div class="nav-tab" data-tab="calls">EMERGENCY CALLS</div>
            <div class="nav-tab" data-tab="shelters">SHELTER OPERATIONS</div>
            <div class="nav-tab" data-tab="resources">RESOURCE MANAGEMENT</div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        
        <!-- OPERATIONAL OVERVIEW Tab -->
        <div id="overview-tab" class="tab-content active">
            
            <!-- Live Status Bar -->
            <div class="summary-bar">
                <div class="summary-item">
                    <div class="summary-label">System Status</div>
                    <div class="summary-value">
                        <span style="color: #48bb78;">OPERATIONAL</span>
                        <div class="live-indicator">
                            <div class="live-dot"></div>
                            LIVE
                        </div>
                    </div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Last Update</div>
                    <div class="summary-value" id="liveTimestamp">14:43:27 UTC</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Active Operations</div>
                    <div class="summary-value">127 CONCURRENT</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Data Sources</div>
                    <div class="summary-value">23 FEEDS ACTIVE</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Coverage Area</div>
                    <div class="summary-value">MO/AR (57 COUNTIES)</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Response Level</div>
                    <div class="summary-value" style="color: #f59e0b;">LEVEL 3 DISASTER</div>
                </div>
            </div>

            <!-- Top Metrics Row -->
            <div class="metrics-row">
                <div class="metric-card">
                    <div class="metric-number">2,847</div>
                    <div class="metric-label">Total Assessments</div>
                    <div class="metric-change positive">+127 today</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">743</div>
                    <div class="metric-label">Critical Damage</div>
                    <div class="metric-change negative">+23 today</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">2,047</div>
                    <div class="metric-label">Emergency Calls</div>
                    <div class="metric-change positive">+89 today</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">418</div>
                    <div class="metric-label">Shelter Occupancy</div>
                    <div class="metric-change neutral">+12 today</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">45</div>
                    <div class="metric-label">Field Teams</div>
                    <div class="metric-change positive">All deployed</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">$2.7M</div>
                    <div class="metric-label">Aid Distributed</div>
                    <div class="metric-change positive">+$340K today</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">89.2%</div>
                    <div class="metric-label">Completion Rate</div>
                    <div class="metric-change positive">+2.1% week</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">4.2min</div>
                    <div class="metric-label">Avg Response</div>
                    <div class="metric-change positive">-0.8min</div>
                </div>
            </div>

            <!-- Main Dashboard Grid -->
            <div class="dashboard-grid">
                
                <!-- Assessment Progress Chart -->
                <div class="card chart-large">
                    <div class="card-header">
                        <div class="card-title">ASSESSMENT PROGRESS BY COUNTY</div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="assessmentProgressChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Damage Distribution -->
                <div class="card chart-medium">
                    <div class="card-header">
                        <div class="card-title">DAMAGE DISTRIBUTION</div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="damageDistributionChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Response Time Trend -->
                <div class="card mini-chart">
                    <div class="card-header">
                        <div class="card-title">RESPONSE TIME</div>
                    </div>
                    <div class="card-body">
                        <div class="kpi-value">4.2 <span class="kpi-unit">min</span></div>
                        <div class="kpi-change positive">↓ 0.8min</div>
                        <div class="chart-container">
                            <canvas id="responseTimeChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Call Volume Heat Map -->
                <div class="card chart-large">
                    <div class="card-header">
                        <div class="card-title">EMERGENCY CALL HEAT MAP</div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="callHeatMapChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Shelter Occupancy -->
                <div class="card chart-medium">
                    <div class="card-header">
                        <div class="card-title">SHELTER CAPACITY STATUS</div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="shelterCapacityChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Priority Alerts -->
                <div class="card mini-chart">
                    <div class="card-header">
                        <div class="card-title">PRIORITY ALERTS</div>
                    </div>
                    <div class="card-body">
                        <div class="kpi-value">23 <span class="kpi-unit">active</span></div>
                        <div class="kpi-change negative">+7 today</div>
                        <div class="chart-container">
                            <canvas id="alertsChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Activity Feed -->
                <div class="card chart-medium">
                    <div class="card-header">
                        <div class="card-title">LIVE ACTIVITY FEED</div>
                    </div>
                    <div class="card-body">
                        <div class="activity-feed" id="activityFeed">
                            <div class="activity-item">
                                <div class="activity-time">14:43</div>
                                <div class="activity-text">New critical damage assessment in Taney County</div>
                                <div class="activity-priority high">HIGH</div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-time">14:41</div>
                                <div class="activity-text">Shelter capacity update - Branson Baptist at 70%</div>
                                <div class="activity-priority medium">MEDIUM</div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-time">14:39</div>
                                <div class="activity-text">Financial aid disbursement completed - $45K</div>
                                <div class="activity-priority low">LOW</div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-time">14:37</div>
                                <div class="activity-text">Field team Alpha-6 deployed to Stone County</div>
                                <div class="activity-priority medium">MEDIUM</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Team Status -->
                <div class="card chart-medium">
                    <div class="card-header">
                        <div class="card-title">FIELD TEAM STATUS</div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="teamStatusChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Operational Matrix -->
                <div class="card chart-full">
                    <div class="card-header">
                        <div class="card-title">OPERATIONAL PERFORMANCE MATRIX</div>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>COUNTY</th>
                                        <th>STATE</th>
                                        <th>ASSESSMENTS</th>
                                        <th>DAMAGE</th>
                                        <th>CALLS</th>
                                        <th>SHELTERS</th>
                                        <th>TEAMS</th>
                                        <th>AID ($)</th>
                                        <th>COMPLETION</th>
                                        <th>PRIORITY</th>
                                        <th>STATUS</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="font-weight: 600; color: #ffffff;">Taney</td>
                                        <td>MO</td>
                                        <td style="font-weight: 600;">342</td>
                                        <td style="color: #f56565; font-weight: 600;">89</td>
                                        <td>298</td>
                                        <td>2</td>
                                        <td>6</td>
                                        <td style="color: #48bb78; font-weight: 600;">$450K</td>
                                        <td style="font-weight: 600;">93.0%</td>
                                        <td><span class="status-badge critical">HIGH</span></td>
                                        <td><span class="status-badge complete">ACTIVE</span></td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 600; color: #ffffff;">Stone</td>
                                        <td>MO</td>
                                        <td style="font-weight: 600;">298</td>
                                        <td style="color: #f56565; font-weight: 600;">72</td>
                                        <td>267</td>
                                        <td>1</td>
                                        <td>5</td>
                                        <td style="color: #48bb78; font-weight: 600;">$380K</td>
                                        <td style="font-weight: 600;">89.6%</td>
                                        <td><span class="status-badge critical">HIGH</span></td>
                                        <td><span class="status-badge complete">ACTIVE</span></td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 600; color: #ffffff;">Barry</td>
                                        <td>MO</td>
                                        <td style="font-weight: 600;">276</td>
                                        <td style="color: #f56565; font-weight: 600;">65</td>
                                        <td>234</td>
                                        <td>1</td>
                                        <td>4</td>
                                        <td style="color: #48bb78; font-weight: 600;">$340K</td>
                                        <td style="font-weight: 600;">84.8%</td>
                                        <td><span class="status-badge critical">HIGH</span></td>
                                        <td><span class="status-badge complete">ACTIVE</span></td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 600; color: #ffffff;">McDonald</td>
                                        <td>MO</td>
                                        <td style="font-weight: 600;">198</td>
                                        <td style="color: #48bb78; font-weight: 600;">48</td>
                                        <td>189</td>
                                        <td>1</td>
                                        <td>3</td>
                                        <td style="color: #48bb78; font-weight: 600;">$280K</td>
                                        <td style="font-weight: 600;">91.9%</td>
                                        <td><span class="status-badge progress">MEDIUM</span></td>
                                        <td><span class="status-badge complete">ACTIVE</span></td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 600; color: #ffffff;">Newton</td>
                                        <td>MO</td>
                                        <td style="font-weight: 600;">187</td>
                                        <td style="color: #48bb78; font-weight: 600;">41</td>
                                        <td>167</td>
                                        <td>1</td>
                                        <td>3</td>
                                        <td style="color: #48bb78; font-weight: 600;">$260K</td>
                                        <td style="font-weight: 600;">83.4%</td>
                                        <td><span class="status-badge progress">MEDIUM</span></td>
                                        <td><span class="status-badge complete">ACTIVE</span></td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 600; color: #ffffff;">Boone</td>
                                        <td>AR</td>
                                        <td style="font-weight: 600;">156</td>
                                        <td style="color: #48bb78; font-weight: 600;">34</td>
                                        <td>134</td>
                                        <td>1</td>
                                        <td>2</td>
                                        <td style="color: #48bb78; font-weight: 600;">$200K</td>
                                        <td style="font-weight: 600;">88.5%</td>
                                        <td><span class="status-badge progress">MEDIUM</span></td>
                                        <td><span class="status-badge complete">ACTIVE</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- EMERGENCY CALLS Tab -->
        <div id="calls-tab" class="tab-content">
            
            <!-- Call Status Bar -->
            <div class="summary-bar">
                <div class="summary-item">
                    <div class="summary-label">Total Call Volume</div>
                    <div class="summary-value">
                        <span>2,047</span>
                        <div class="live-indicator">
                            <div class="live-dot"></div>
                            LIVE
                        </div>
                    </div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Response Time</div>
                    <div class="summary-value">4.2 MIN AVG</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Resolution Rate</div>
                    <div class="summary-value">94.3% SUCCESS</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Queue Status</div>
                    <div class="summary-value" style="color: #48bb78;">7 WAITING</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Critical Calls</div>
                    <div class="summary-value" style="color: #f56565;">89 HIGH</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Operators Active</div>
                    <div class="summary-value">23/25 ONLINE</div>
                </div>
            </div>

            <!-- Filters -->
            <div class="filters">
                <div class="filter-group">
                    <div class="filter-label">TYPE:</div>
                    <select class="filter-select">
                        <option>ALL TYPES</option>
                        <option>WATER</option>
                        <option>FOOD</option>
                        <option>SHELTER</option>
                        <option>FINANCIAL</option>
                    </select>
                </div>
                <div class="filter-group">
                    <div class="filter-label">PRIORITY:</div>
                    <select class="filter-select">
                        <option>ALL PRIORITIES</option>
                        <option>CRITICAL</option>
                        <option>HIGH</option>
                        <option>MEDIUM</option>
                    </select>
                </div>
                <div class="filter-actions">
                    <button class="btn">EXPORT</button>
                    <button class="btn">PRINT</button>
                    <button class="btn primary">REFRESH</button>
                </div>
            </div>

            <!-- Call Metrics -->
            <div class="metrics-row">
                <div class="metric-card">
                    <div class="metric-number">127</div>
                    <div class="metric-label">Today's Calls</div>
                    <div class="metric-change positive">+8.3%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">89</div>
                    <div class="metric-label">Critical Priority</div>
                    <div class="metric-change negative">+7 new</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">1,535</div>
                    <div class="metric-label">General Support</div>
                    <div class="metric-change neutral">75.0%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">307</div>
                    <div class="metric-label">Financial Aid</div>
                    <div class="metric-change positive">15.0%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">164</div>
                    <div class="metric-label">Water Assistance</div>
                    <div class="metric-change neutral">8.0%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">143</div>
                    <div class="metric-label">Emergency Shelter</div>
                    <div class="metric-change positive">7.0%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">82</div>
                    <div class="metric-label">Food/Nutrition</div>
                    <div class="metric-change neutral">4.0%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">97.2%</div>
                    <div class="metric-label">SLA Compliance</div>
                    <div class="metric-change positive">+1.2%</div>
                </div>
            </div>

            <!-- Call Charts Grid -->
            <div class="dashboard-grid">
                
                <!-- Call Type Distribution -->
                <div class="card chart-medium">
                    <div class="card-header">
                        <div class="card-title">CALL TYPE DISTRIBUTION</div>
                    </div>
                    <div class="card-body">
                        <div class="progress-container">
                            <div class="progress-label">
                                <span class="progress-label-text">General Support</span>
                                <span class="progress-label-value">1,535 (75.0%)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill info" style="width: 75%;"></div>
                            </div>
                        </div>
                        
                        <div class="progress-container">
                            <div class="progress-label">
                                <span class="progress-label-text">Financial Assistance</span>
                                <span class="progress-label-value">307 (15.0%)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill warning" style="width: 15%;"></div>
                            </div>
                        </div>
                        
                        <div class="progress-container">
                            <div class="progress-label">
                                <span class="progress-label-text">Water Assistance</span>
                                <span class="progress-label-value">164 (8.0%)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill success" style="width: 8%;"></div>
                            </div>
                        </div>
                        
                        <div class="progress-container">
                            <div class="progress-label">
                                <span class="progress-label-text">Emergency Shelter</span>
                                <span class="progress-label-value">143 (7.0%)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill critical" style="width: 7%;"></div>
                            </div>
                        </div>
                        
                        <div class="progress-container">
                            <div class="progress-label">
                                <span class="progress-label-text">Food/Nutrition</span>
                                <span class="progress-label-value">82 (4.0%)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill info" style="width: 4%;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Call Volume Heat Map -->
                <div class="card chart-large">
                    <div class="card-header">
                        <div class="card-title">GEOGRAPHIC CALL INTENSITY</div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="geoHeatMap"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Priority Distribution -->
                <div class="card chart-medium">
                    <div class="card-header">
                        <div class="card-title">PRIORITY LEVELS</div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="priorityChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Call Timeline -->
                <div class="card chart-full">
                    <div class="card-header">
                        <div class="card-title">HOURLY CALL VOLUME ANALYSIS</div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="callTimelineChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SHELTER OPERATIONS Tab -->
        <div id="shelters-tab" class="tab-content">
            
            <!-- Shelter Status Bar -->
            <div class="summary-bar">
                <div class="summary-item">
                    <div class="summary-label">Active Shelters</div>
                    <div class="summary-value">
                        <span>10</span>
                        <div class="live-indicator">
                            <div class="live-dot"></div>
                            LIVE
                        </div>
                    </div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Total Capacity</div>
                    <div class="summary-value">742 PEOPLE</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Current Occupancy</div>
                    <div class="summary-value">418 (56.3%)</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Available Space</div>
                    <div class="summary-value" style="color: #48bb78;">324 BEDS</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">New Arrivals</div>
                    <div class="summary-value">23 TODAY</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Average Stay</div>
                    <div class="summary-value">5.2 DAYS</div>
                </div>
            </div>

            <!-- Shelter Metrics -->
            <div class="metrics-row">
                <div class="metric-card">
                    <div class="metric-number">67/95</div>
                    <div class="metric-label">Branson Baptist</div>
                    <div class="metric-change neutral">70.5%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">51/72</div>
                    <div class="metric-label">Reeds Spring</div>
                    <div class="metric-change neutral">70.8%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">59/84</div>
                    <div class="metric-label">Cassville Methodist</div>
                    <div class="metric-change positive">70.2%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">44/65</div>
                    <div class="metric-label">Anderson Baptist</div>
                    <div class="metric-change positive">67.7%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">62/78</div>
                    <div class="metric-label">Neosho Christian</div>
                    <div class="metric-change negative">79.5%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">23/58</div>
                    <div class="metric-label">Mt Vernon</div>
                    <div class="metric-change positive">39.7%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">45/89</div>
                    <div class="metric-label">Harrison Baptist</div>
                    <div class="metric-change neutral">50.6%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-number">418/742</div>
                    <div class="metric-label">All Shelters Total</div>
                    <div class="metric-change positive">56.3%</div>
                </div>
            </div>

            <!-- Shelter Charts Grid -->
            <div class="dashboard-grid">
                
                <!-- Shelter Capacity Chart -->
                <div class="card chart-large">
                    <div class="card-header">
                        <div class="card-title">SHELTER CAPACITY VS OCCUPANCY</div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="shelterCapChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Demographics -->
                <div class="card chart-medium">
                    <div class="card-header">
                        <div class="card-title">SHELTER DEMOGRAPHICS</div>
                    </div>
                    <div class="card-body">
                        <div class="progress-container">
                            <div class="progress-label">
                                <span class="progress-label-text">Adults (18+)</span>
                                <span class="progress-label-value">267 (63.9%)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill info" style="width: 63.9%;"></div>
                            </div>
                        </div>
                        
                        <div class="progress-container">
                            <div class="progress-label">
                                <span class="progress-label-text">Children (5-17)</span>
                                <span class="progress-label-value">109 (26.1%)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill success" style="width: 26.1%;"></div>
                            </div>
                        </div>
                        
                        <div class="progress-container">
                            <div class="progress-label">
                                <span class="progress-label-text">Young Children</span>
                                <span class="progress-label-value">42 (10.0%)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill warning" style="width: 10%;"></div>
                            </div>
                        </div>
                        
                        <div class="progress-container">
                            <div class="progress-label">
                                <span class="progress-label-text">Special Needs</span>
                                <span class="progress-label-value">34 (8.1%)</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill critical" style="width: 8.1%;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Occupancy Trend -->
                <div class="card mini-chart">
                    <div class="card-header">
                        <div class="card-title">7-DAY TREND</div>
                    </div>
                    <div class="card-body">
                        <div class="kvi-value">56.3%</div>
                        <div class="kpi-change positive">+4.1%</div>
                        <div class="chart-container">
                            <canvas id="occupancyTrendChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Shelter Map -->
                <div class="card chart-large">
                    <div class="card-header">
                        <div class="card-title">SHELTER LOCATIONS & STATUS</div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="shelterMapChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Shelter Directory -->
                <div class="card chart-full">
                    <div class="card-header">
                        <div class="card-title">SHELTER DIRECTORY & CONTACT MATRIX</div>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>SHELTER NAME</th>
                                        <th>ADDRESS</th>
                                        <th>CONTACT</th>
                                        <th>PHONE</th>
                                        <th>CAPACITY</th>
                                        <th>CURRENT</th>
                                        <th>AVAILABLE</th>
                                        <th>UTIL%</th>
                                        <th>STATUS</th>
                                        <th>SUPPLIES</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="font-weight: 600; color: #ffffff;">First Baptist Church of Branson</td>
                                        <td>1051 Bird Rd, Branson, MO 65616</td>
                                        <td>Sarah Martinez</td>
                                        <td>(417) 334-2266</td>
                                        <td>95</td>
                                        <td style="font-weight: 600;">67</td>
                                        <td style="color: #48bb78; font-weight: 600;">28</td>
                                        <td style="font-weight: 600;">70.5%</td>
                                        <td><span class="status-badge complete">AVAILABLE</span></td>
                                        <td><span class="status-badge complete">GOOD</span></td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 600; color: #ffffff;">Reeds Spring Methodist Church</td>
                                        <td>13370 State Hwy 13, Reeds Spring, MO 65737</td>
                                        <td>Michael Thompson</td>
                                        <td>(417) 272-8356</td>
                                        <td>72</td>
                                        <td style="font-weight: 600;">51</td>
                                        <td style="color: #48bb78; font-weight: 600;">21</td>
                                        <td style="font-weight: 600;">70.8%</td>
                                        <td><span class="status-badge complete">AVAILABLE</span></td>
                                        <td><span class="status-badge progress">FAIR</span></td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 600; color: #ffffff;">Cassville First United Methodist</td>
                                        <td>318 Main St, Cassville, MO 65625</td>
                                        <td>Jennifer Lee</td>
                                        <td>(417) 847-2717</td>
                                        <td>84</td>
                                        <td style="font-weight: 600;">59</td>
                                        <td style="color: #48bb78; font-weight: 600;">25</td>
                                        <td style="font-weight: 600;">70.2%</td>
                                        <td><span class="status-badge complete">AVAILABLE</span></td>
                                        <td><span class="status-badge complete">GOOD</span></td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 600; color: #ffffff;">Anderson Baptist Church</td>
                                        <td>400 Elm St, Anderson, MO 64831</td>
                                        <td>Robert Davis</td>
                                        <td>(417) 845-3214</td>
                                        <td>65</td>
                                        <td style="font-weight: 600;">44</td>
                                        <td style="color: #48bb78; font-weight: 600;">21</td>
                                        <td style="font-weight: 600;">67.7%</td>
                                        <td><span class="status-badge complete">AVAILABLE</span></td>
                                        <td><span class="status-badge complete">EXCELLENT</span></td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 600; color: #ffffff;">Neosho First Christian Church</td>
                                        <td>510 N Wood St, Neosho, MO 64850</td>
                                        <td>Amanda Wilson</td>
                                        <td>(417) 451-1234</td>
                                        <td>78</td>
                                        <td style="font-weight: 600;">62</td>
                                        <td style="color: #f56565; font-weight: 600;">16</td>
                                        <td style="font-weight: 600;">79.5%</td>
                                        <td><span class="status-badge progress">LIMITED</span></td>
                                        <td><span class="status-badge progress">FAIR</span></td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 600; color: #ffffff;">Mt. Vernon Baptist Church</td>
                                        <td>123 Church St, Mt. Vernon, MO 65712</td>
                                        <td>David Brown</td>
                                        <td>(417) 466-7891</td>
                                        <td>58</td>
                                        <td style="font-weight: 600;">23</td>
                                        <td style="color: #48bb78; font-weight: 600;">35</td>
                                        <td style="font-weight: 600;">39.7%</td>
                                        <td><span class="status-badge complete">AVAILABLE</span></td>
                                        <td><span class="status-badge complete">GOOD</span></td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: 600; color: #ffffff;">Harrison First Baptist Church</td>
                                        <td>804 N Main St, Harrison, AR 72601</td>
                                        <td>Lisa Garcia</td>
                                        <td>(870) 741-5623</td>
                                        <td>89</td>
                                        <td style="font-weight: 600;">45</td>
                                        <td style="color: #48bb78; font-weight: 600;">44</td>
                                        <td style="font-weight: 600;">50.6%</td>
                                        <td><span class="status-badge complete">AVAILABLE</span></td>
                                        <td><span class="status-badge complete">GOOD</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Stable Dashboard Implementation
        console.log('🚀 Initializing Emergency Operations Dashboard...');
        
        // Initialize when DOM loads
        document.addEventListener('DOMContentLoaded', function() {
            try {
                initializeDashboard();
            } catch (error) {
                console.error('Dashboard initialization error:', error);
            }
        });

        function initializeDashboard() {
            setupTabs();
            updateTimestamp();
            createAllCharts();
            startLiveUpdates();
            console.log('✅ Dashboard Fully Operational');
        }

        function setupTabs() {
            const tabs = document.querySelectorAll('.nav-tab');
            const contents = document.querySelectorAll('.tab-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetTab = this.dataset.tab;
                    
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    contents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === targetTab + '-tab') {
                            content.classList.add('active');
                            setTimeout(() => createAllCharts(), 100);
                        }
                    });
                });
            });
        }

        function createAllCharts() {
            try {
                // Overview charts
                createAssessmentProgressChart();
                createDamageDistributionChart();
                createResponseTimeChart();
                createCallHeatMapChart();
                createShelterCapacityChart();
                createAlertsChart();
                createTeamStatusChart();

                // Call charts
                createGeoHeatMap();
                createPriorityChart();
                createCallTimelineChart();

                // Shelter charts
                createShelterCapChart();
                createOccupancyTrendChart();
                createShelterMapChart();
            } catch (error) {
                console.error('Chart creation error:', error);
            }
        }

        function createAssessmentProgressChart() {
            const canvas = document.getElementById('assessmentProgressChart');
            if (!canvas) return;
            
            try {
                const ctx = canvas.getContext('2d');
                const rect = canvas.parentElement.getBoundingClientRect();
                
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                const counties = ['Taney', 'Stone', 'Barry', 'McDonald', 'Newton', 'Lawrence', 'Boone', 'Carroll'];
                const assessments = [342, 298, 276, 198, 187, 164, 156, 142];
                const damage = [89, 72, 65, 48, 41, 37, 34, 29];
                
                const maxValue = Math.max(...assessments);
                const margin = { top: 30, right: 30, bottom: 60, left: 50 };
                const chartWidth = rect.width - margin.left - margin.right;
                const chartHeight = rect.height - margin.top - margin.bottom;
                const barWidth = chartWidth / counties.length * 0.7;
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                // Grid lines
                ctx.strokeStyle = '#4a5568';
                ctx.lineWidth = 1;
                for (let i = 0; i <= 5; i++) {
                    const y = margin.top + (chartHeight / 5) * i;
                    ctx.beginPath();
                    ctx.moveTo(margin.left, y);
                    ctx.lineTo(rect.width - margin.right, y);
                    ctx.stroke();
                    
                    ctx.fillStyle = '#a0aec0';
                    ctx.font = '10px Inter';
                    ctx.textAlign = 'right';
                    const value = Math.round((maxValue / 5) * (5 - i));
                    ctx.fillText(value.toString(), margin.left - 10, y + 3);
                }
                
                // Draw bars
                counties.forEach((county, index) => {
                    const x = margin.left + index * (chartWidth / counties.length) + (chartWidth / counties.length - barWidth) / 2;
                    const assessmentHeight = (assessments[index] / maxValue) * chartHeight;
                    const damageHeight = (damage[index] / maxValue) * chartHeight;
                    
                    // Assessment bar
                    ctx.fillStyle = '#4299e1';
                    ctx.fillRect(x, margin.top + chartHeight - assessmentHeight, barWidth * 0.45, assessmentHeight);
                    
                    // Damage bar
                    ctx.fillStyle = '#f56565';
                    ctx.fillRect(x + barWidth * 0.5, margin.top + chartHeight - damageHeight, barWidth * 0.45, damageHeight);
                    
                    // County label
                    ctx.fillStyle = '#ffffff';
                    ctx.font = 'bold 9px Inter';
                    ctx.textAlign = 'center';
                    ctx.save();
                    ctx.translate(x + barWidth / 2, rect.height - margin.bottom + 20);
                    ctx.rotate(-Math.PI / 6);
                    ctx.fillText(county, 0, 0);
                    ctx.restore();
                    
                    // Values
                    ctx.fillStyle = '#ffffff';
                    ctx.font = 'bold 8px Inter';
                    ctx.textAlign = 'center';
                    if (assessmentHeight > 15) {
                        ctx.fillText(assessments[index].toString(), x + barWidth * 0.225, margin.top + chartHeight - assessmentHeight / 2 + 2);
                    }
                    if (damageHeight > 15) {
                        ctx.fillText(damage[index].toString(), x + barWidth * 0.725, margin.top + chartHeight - damageHeight / 2 + 2);
                    }
                });
                
                // Legend
                ctx.fillStyle = '#4299e1';
                ctx.fillRect(margin.left, 15, 12, 8);
                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 9px Inter';
                ctx.textAlign = 'left';
                ctx.fillText('ASSESSMENTS', margin.left + 18, 22);
                
                ctx.fillStyle = '#f56565';
                ctx.fillRect(margin.left + 120, 15, 12, 8);
                ctx.fillText('DAMAGE', margin.left + 138, 22);
            } catch (error) {
                console.error('Assessment chart error:', error);
            }
        }

        function createDamageDistributionChart() {
            const canvas = document.getElementById('damageDistributionChart');
            if (!canvas) return;
            
            try {
                const ctx = canvas.getContext('2d');
                const rect = canvas.parentElement.getBoundingClientRect();
                
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                const data = {
                    'Minor': { value: 1234, color: '#48bb78' },
                    'Moderate': { value: 520, color: '#ed8936' },
                    'Major': { value: 487, color: '#f56565' },
                    'Destroyed': { value: 198, color: '#c53030' },
                    'Inaccessible': { value: 45, color: '#718096' }
                };
                
                const total = Object.values(data).reduce((sum, item) => sum + item.value, 0);
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                const radius = Math.min(rect.width, rect.height) * 0.3;
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                let currentAngle = -Math.PI / 2;
                
                Object.entries(data).forEach(([label, item]) => {
                    const sliceAngle = (item.value / total) * 2 * Math.PI;
                    
                    // Draw slice
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                    ctx.closePath();
                    ctx.fillStyle = item.color;
                    ctx.fill();
                    
                    ctx.strokeStyle = '#1a202c';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    
                    // Labels
                    const labelAngle = currentAngle + sliceAngle / 2;
                    const labelRadius = radius + 20;
                    const labelX = centerX + Math.cos(labelAngle) * labelRadius;
                    const labelY = centerY + Math.sin(labelAngle) * labelRadius;
                    
                    ctx.fillStyle = '#ffffff';
                    ctx.font = 'bold 8px Inter';
                    ctx.textAlign = labelX > centerX ? 'left' : 'right';
                    ctx.fillText(label, labelX, labelY - 2);
                    
                    ctx.font = '7px Inter';
                    ctx.fillStyle = '#a0aec0';
                    ctx.fillText(item.value.toLocaleString(), labelX, labelY + 6);
                    
                    const percentage = ((item.value / total) * 100).toFixed(1);
                    ctx.fillText(percentage + '%', labelX, labelY + 14);
                    
                    currentAngle += sliceAngle;
                });
                
                // Center circle
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius * 0.4, 0, 2 * Math.PI);
                ctx.fillStyle = '#2d3748';
                ctx.fill();
                ctx.strokeStyle = '#4a5568';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 10px Inter';
                ctx.textAlign = 'center';
                ctx.fillText('TOTAL', centerX, centerY - 4);
                ctx.font = 'bold 9px Inter';
                ctx.fillText(total.toLocaleString(), centerX, centerY + 8);
            } catch (error) {
                console.error('Damage chart error:', error);
            }
        }

        function createResponseTimeChart() {
            const canvas = document.getElementById('responseTimeChart');
            if (!canvas) return;
            
            try {
                const ctx = canvas.getContext('2d');
                const rect = canvas.parentElement.getBoundingClientRect();
                
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                const data = [5.2, 4.8, 4.5, 4.3, 4.1, 3.9, 4.2, 4.4, 4.3, 4.1, 4.0, 4.2, 4.3, 4.2];
                const maxValue = Math.max(...data) + 0.5;
                const minValue = Math.min(...data) - 0.5;
                const range = maxValue - minValue;
                
                const margin = { top: 10, right: 10, bottom: 20, left: 20 };
                const chartWidth = rect.width - margin.left - margin.right;
                const chartHeight = rect.height - margin.top - margin.bottom;
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                const stepX = chartWidth / (data.length - 1);
                
                // Area fill
                ctx.beginPath();
                data.forEach((value, index) => {
                    const x = margin.left + index * stepX;
                    const y = margin.top + chartHeight - ((value - minValue) / range) * chartHeight;
                    if (index === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                });
                ctx.lineTo(margin.left + chartWidth, margin.top + chartHeight);
                ctx.lineTo(margin.left, margin.top + chartHeight);
                ctx.closePath();
                
                ctx.fillStyle = 'rgba(72, 187, 120, 0.2)';
                ctx.fill();
                
                // Line
                ctx.strokeStyle = '#48bb78';
                ctx.lineWidth = 2;
                ctx.beginPath();
                data.forEach((value, index) => {
                    const x = margin.left + index * stepX;
                    const y = margin.top + chartHeight - ((value - minValue) / range) * chartHeight;
                    if (index === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                });
                ctx.stroke();
                
                // End point
                const lastValue = data[data.length - 1];
                const lastX = margin.left + (data.length - 1) * stepX;
                const lastY = margin.top + chartHeight - ((lastValue - minValue) / range) * chartHeight;
                
                ctx.fillStyle = '#2d3748';
                ctx.beginPath();
                ctx.arc(lastX, lastY, 3, 0, 2 * Math.PI);
                ctx.fill();
                ctx.strokeStyle = '#48bb78';
                ctx.lineWidth = 2;
                ctx.stroke();
            } catch (error) {
                console.error('Response time chart error:', error);
            }
        }

        function createCallHeatMapChart() {
            const canvas = document.getElementById('callHeatMapChart');
            if (!canvas) return;
            
            try {
                const ctx = canvas.getContext('2d');
                const rect = canvas.parentElement.getBoundingClientRect();
                
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                const counties = [
                    { name: 'Taney', calls: 298 },
                    { name: 'Stone', calls: 267 },
                    { name: 'Barry', calls: 234 },
                    { name: 'McDonald', calls: 189 },
                    { name: 'Newton', calls: 167 },
                    { name: 'Lawrence', calls: 145 },
                    { name: 'Boone', calls: 134 },
                    { name: 'Carroll', calls: 123 },
                    { name: 'Madison', calls: 112 },
                    { name: 'Washington', calls: 98 }
                ];
                
                const maxCalls = Math.max(...counties.map(c => c.calls));
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                const margin = { top: 30, right: 30, bottom: 30, left: 30 };
                const mapWidth = rect.width - margin.left - margin.right;
                const mapHeight = rect.height - margin.top - margin.bottom;
                
                // State boundaries
                ctx.strokeStyle = '#4a5568';
                ctx.lineWidth = 2;
                ctx.fillStyle = '#2d3748';
                
                // Missouri
                ctx.beginPath();
                ctx.rect(margin.left, margin.top, mapWidth * 0.6, mapHeight * 0.6);
                ctx.fill();
                ctx.stroke();
                
                // Arkansas
                ctx.beginPath();
                ctx.rect(margin.left + mapWidth * 0.1, margin.top + mapHeight * 0.4, mapWidth * 0.7, mapHeight * 0.5);
                ctx.fill();
                ctx.stroke();
                
                // State labels
                ctx.fillStyle = '#a0aec0';
                ctx.font = 'bold 12px Inter';
                ctx.textAlign = 'center';
                ctx.fillText('MISSOURI', margin.left + mapWidth * 0.3, margin.top + mapHeight * 0.25);
                ctx.fillText('ARKANSAS', margin.left + mapWidth * 0.45, margin.top + mapHeight * 0.7);
                
                // Plot counties
                counties.forEach((county, index) => {
                    const intensity = county.calls / maxCalls;
                    const x = margin.left + (index % 5) * (mapWidth / 5) + mapWidth / 10;
                    const y = margin.top + Math.floor(index / 5) * (mapHeight / 3) + mapHeight / 6;
                    const radius = 6 + intensity * 12;
                    
                    // Heat circle
                    const alpha = 0.4 + intensity * 0.6;
                    ctx.fillStyle = `rgba(245, 101, 101, ${alpha})`;
                    ctx.beginPath();
                    ctx.arc(x, y, radius, 0, 2 * Math.PI);
                    ctx.fill();
                    
                    // County label
                    ctx.fillStyle = '#ffffff';
                    ctx.font = 'bold 7px Inter';
                    ctx.textAlign = 'center';
                    ctx.fillText(county.name, x, y - radius - 8);
                    
                    // Call count
                    ctx.font = '6px Inter';
                    ctx.fillStyle = '#e2e8f0';
                    ctx.fillText(county.calls.toString(), x, y + radius + 10);
                });
                
                // Legend
                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 9px Inter';
                ctx.textAlign = 'left';
                ctx.fillText('CALL INTENSITY', margin.left, 20);
                
                for (let i = 0; i < 5; i++) {
                    const x = rect.width - margin.right - 80 + i * 12;
                    const alpha = 0.4 + (i / 4) * 0.6;
                    ctx.fillStyle = `rgba(245, 101, 101, ${alpha})`;
                    ctx.beginPath();
                    ctx.arc(x, 20, 4, 0, 2 * Math.PI);
                    ctx.fill();
                }
            } catch (error) {
                console.error('Heat map chart error:', error);
            }
        }

        function createShelterCapacityChart() {
            const canvas = document.getElementById('shelterCapacityChart');
            if (!canvas) return;
            
            try {
                const ctx = canvas.getContext('2d');
                const rect = canvas.parentElement.getBoundingClientRect();
                
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                const shelters = [
                    { name: 'Branson', capacity: 95, current: 67 },
                    { name: 'Reeds Spring', capacity: 72, current: 51 },
                    { name: 'Cassville', capacity: 84, current: 59 },
                    { name: 'Anderson', capacity: 65, current: 44 },
                    { name: 'Neosho', capacity: 78, current: 62 },
                    { name: 'Mt Vernon', capacity: 58, current: 23 }
                ];
                
                const maxCapacity = Math.max(...shelters.map(s => s.capacity));
                const margin = { top: 30, right: 30, bottom: 60, left: 40 };
                const chartWidth = rect.width - margin.left - margin.right;
                const chartHeight = rect.height - margin.top - margin.bottom;
                const barWidth = chartWidth / shelters.length * 0.7;
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                // Grid
                ctx.strokeStyle = '#4a5568';
                ctx.lineWidth = 1;
                for (let i = 0; i <= 5; i++) {
                    const y = margin.top + (chartHeight / 5) * i;
                    ctx.beginPath();
                    ctx.moveTo(margin.left, y);
                    ctx.lineTo(rect.width - margin.right, y);
                    ctx.stroke();
                    
                    ctx.fillStyle = '#a0aec0';
                    ctx.font = '9px Inter';
                    ctx.textAlign = 'right';
                    const value = Math.round((maxCapacity / 5) * (5 - i));
                    ctx.fillText(value.toString(), margin.left - 8, y + 3);
                }
                
                // Draw bars
                shelters.forEach((shelter, index) => {
                    const x = margin.left + index * (chartWidth / shelters.length) + (chartWidth / shelters.length - barWidth) / 2;
                    const capacityHeight = (shelter.capacity / maxCapacity) * chartHeight;
                    const currentHeight = (shelter.current / maxCapacity) * chartHeight;
                    const utilization = shelter.current / shelter.capacity;
                    
                    // Capacity bar
                    ctx.fillStyle = '#4a5568';
                    ctx.fillRect(x, margin.top + chartHeight - capacityHeight, barWidth, capacityHeight);
                    
                    // Current occupancy bar
                    let occupancyColor = '#48bb78';
                    if (utilization > 0.8) occupancyColor = '#f56565';
                    else if (utilization > 0.6) occupancyColor = '#ed8936';
                    
                    ctx.fillStyle = occupancyColor;
                    ctx.fillRect(x, margin.top + chartHeight - currentHeight, barWidth, currentHeight);
                    
                    // Shelter name
                    ctx.fillStyle = '#ffffff';
                    ctx.font = 'bold 8px Inter';
                    ctx.textAlign = 'center';
                    ctx.save();
                    ctx.translate(x + barWidth / 2, rect.height - margin.bottom + 20);
                    ctx.rotate(-Math.PI / 6);
                    ctx.fillText(shelter.name, 0, 0);
                    ctx.restore();
                    
                    // Utilization percentage
                    ctx.fillStyle = '#ffffff';
                    ctx.font = 'bold 7px Inter';
                    ctx.textAlign = 'center';
                    if (currentHeight > 15) {
                        const percentage = Math.round(utilization * 100);
                        ctx.fillText(percentage + '%', x + barWidth / 2, margin.top + chartHeight - currentHeight / 2 + 2);
                    }
                });
                
                // Legend
                ctx.fillStyle = '#4a5568';
                ctx.fillRect(margin.left, 15, 12, 8);
                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 8px Inter';
                ctx.textAlign = 'left';
                ctx.fillText('CAPACITY', margin.left + 18, 22);
                
                ctx.fillStyle = '#48bb78';
                ctx.fillRect(margin.left + 80, 15, 12, 8);
                ctx.fillText('CURRENT', margin.left + 98, 22);
            } catch (error) {
                console.error('Shelter capacity chart error:', error);
            }
        }

        function createAlertsChart() {
            const canvas = document.getElementById('alertsChart');
            if (!canvas) return;
            
            try {
                const ctx = canvas.getContext('2d');
                const rect = canvas.parentElement.getBoundingClientRect();
                
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                const alertData = [15, 18, 21, 19, 23, 26, 24, 23, 25, 23];
                const maxValue = Math.max(...alertData);
                const minValue = Math.min(...alertData) - 2;
                const range = maxValue - minValue;
                
                const margin = { top: 10, right: 10, bottom: 10, left: 10 };
                const chartWidth = rect.width - margin.left - margin.right;
                const chartHeight = rect.height - margin.top - margin.bottom;
                const stepX = chartWidth / (alertData.length - 1);
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                // Area fill
                ctx.beginPath();
                alertData.forEach((value, index) => {
                    const x = margin.left + index * stepX;
                    const y = margin.top + chartHeight - ((value - minValue) / range) * chartHeight;
                    if (index === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                });
                ctx.lineTo(margin.left + chartWidth, margin.top + chartHeight);
                ctx.lineTo(margin.left, margin.top + chartHeight);
                ctx.closePath();
                
                ctx.fillStyle = 'rgba(245, 101, 101, 0.3)';
                ctx.fill();
                
                // Line
                ctx.strokeStyle = '#f56565';
                ctx.lineWidth = 2;
                ctx.beginPath();
                alertData.forEach((value, index) => {
                    const x = margin.left + index * stepX;
                    const y = margin.top + chartHeight - ((value - minValue) / range) * chartHeight;
                    if (index === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                });
                ctx.stroke();
                
                // End point
                const lastValue = alertData[alertData.length - 1];
                const lastX = margin.left + (alertData.length - 1) * stepX;
                const lastY = margin.top + chartHeight - ((lastValue - minValue) / range) * chartHeight;
                
                ctx.fillStyle = '#2d3748';
                ctx.beginPath();
                ctx.arc(lastX, lastY, 3, 0, 2 * Math.PI);
                ctx.fill();
                ctx.strokeStyle = '#f56565';
                ctx.lineWidth = 2;
                ctx.stroke();
            } catch (error) {
                console.error('Alerts chart error:', error);
            }
        }

        function createTeamStatusChart() {
            const canvas = document.getElementById('teamStatusChart');
            if (!canvas) return;
            
            try {
                const ctx = canvas.getContext('2d');
                const rect = canvas.parentElement.getBoundingClientRect();
                
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                const teams = [
                    { id: 'A1', status: 'active', x: 30, y: 40 },
                    { id: 'A2', status: 'active', x: 60, y: 35 },
                    { id: 'A3', status: 'transit', x: 90, y: 50 },
                    { id: 'B1', status: 'active', x: 120, y: 45 },
                    { id: 'B2', status: 'standby', x: 150, y: 30 },
                    { id: 'B3', status: 'active', x: 180, y: 55 },
                    { id: 'C1', status: 'transit', x: 210, y: 40 },
                    { id: 'C2', status: 'active', x: 240, y: 48 }
                ];
                
                const statusColors = {
                    'active': '#48bb78',
                    'transit': '#ed8936',
                    'standby': '#4299e1'
                };
                
                teams.forEach(team => {
                    if (team.x < rect.width - 20) { // Only draw if within canvas
                        // Team position
                        ctx.fillStyle = statusColors[team.status];
                        ctx.beginPath();
                        ctx.arc(team.x, team.y + 30, 5, 0, 2 * Math.PI);
                        ctx.fill();
                        
                        // Team ID
                        ctx.fillStyle = '#ffffff';
                        ctx.font = 'bold 6px Inter';
                        ctx.textAlign = 'center';
                        ctx.fillText(team.id, team.x, team.y + 15);
                    }
                });
                
                // Legend
                const legendItems = Object.entries(statusColors);
                legendItems.forEach(([status, color], index) => {
                    const x = 20 + index * 50;
                    const y = rect.height - 15;
                    
                    if (x < rect.width - 40) { // Only draw if within canvas
                        ctx.fillStyle = color;
                        ctx.beginPath();
                        ctx.arc(x, y, 3, 0, 2 * Math.PI);
                        ctx.fill();
                        
                        ctx.fillStyle = '#ffffff';
                        ctx.font = '6px Inter';
                        ctx.textAlign = 'left';
                        ctx.fillText(status.toUpperCase(), x + 6, y + 2);
                    }
                });
            } catch (error) {
                console.error('Team status chart error:', error);
            }
        }

        function createGeoHeatMap() {
            // Reuse the call heat map for the calls tab
            createCallHeatMapChart();
        }

        function createPriorityChart() {
            const canvas = document.getElementById('priorityChart');
            if (!canvas) return;
            
            try {
                const ctx = canvas.getContext('2d');
                const rect = canvas.parentElement.getBoundingClientRect();
                
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                const priorityData = {
                    'Critical': { value: 89, color: '#f56565' },
                    'High': { value: 339, color: '#ed8936' },
                    'Medium': { value: 758, color: '#4299e1' },
                    'Low': { value: 861, color: '#48bb78' }
                };
                
                const total = Object.values(priorityData).reduce((sum, item) => sum + item.value, 0);
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                const radius = Math.min(rect.width, rect.height) * 0.32;
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                let currentAngle = -Math.PI / 2;
                
                Object.entries(priorityData).forEach(([priority, item]) => {
                    const sliceAngle = (item.value / total) * 2 * Math.PI;
                    
                    // Draw slice
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                    ctx.closePath();
                    ctx.fillStyle = item.color;
                    ctx.fill();
                    
                    ctx.strokeStyle = '#1a202c';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    
                    // Labels
                    const labelAngle = currentAngle + sliceAngle / 2;
                    const labelRadius = radius + 15;
                    const labelX = centerX + Math.cos(labelAngle) * labelRadius;
                    const labelY = centerY + Math.sin(labelAngle) * labelRadius;
                    
                    ctx.fillStyle = '#ffffff';
                    ctx.font = 'bold 7px Inter';
                    ctx.textAlign = 'center';
                    ctx.fillText(priority, labelX, labelY);
                    
                    ctx.font = '6px Inter';
                    ctx.fillStyle = '#a0aec0';
                    ctx.fillText(item.value.toString(), labelX, labelY + 8);
                    
                    currentAngle += sliceAngle;
                });
                
                // Center circle
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius * 0.4, 0, 2 * Math.PI);
                ctx.fillStyle = '#2d3748';
                ctx.fill();
                ctx.strokeStyle = '#4a5568';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 7px Inter';
                ctx.textAlign = 'center';
                ctx.fillText('PRIORITY', centerX, centerY - 2);
                ctx.font = 'bold 6px Inter';
                ctx.fillText('CALLS', centerX, centerY + 8);
            } catch (error) {
                console.error('Priority chart error:', error);
            }
        }

        function createCallTimelineChart() {
            const canvas = document.getElementById('callTimelineChart');
            if (!canvas) return;
            
            try {
                const ctx = canvas.getContext('2d');
                const rect = canvas.parentElement.getBoundingClientRect();
                
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                const hourlyData = [
                    12, 8, 6, 4, 7, 15, 28, 45, 67, 89, 112, 125,
                    134, 128, 119, 108, 95, 82, 76, 63, 48, 35, 25, 18
                ];
                
                const maxCalls = Math.max(...hourlyData);
                const margin = { top: 20, right: 20, bottom: 40, left: 40 };
                const chartWidth = rect.width - margin.left - margin.right;
                const chartHeight = rect.height - margin.top - margin.bottom;
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                // Grid
                ctx.strokeStyle = '#4a5568';
                ctx.lineWidth = 1;
                for (let i = 0; i <= 5; i++) {
                    const y = margin.top + (chartHeight / 5) * i;
                    ctx.beginPath();
                    ctx.moveTo(margin.left, y);
                    ctx.lineTo(rect.width - margin.right, y);
                    ctx.stroke();
                    
                    ctx.fillStyle = '#a0aec0';
                    ctx.font = '8px Inter';
                    ctx.textAlign = 'right';
                    const value = Math.round((maxCalls / 5) * (5 - i));
                    ctx.fillText(value.toString(), margin.left - 8, y + 3);
                }
                
                // Draw bars
                const barWidth = chartWidth / 24;
                hourlyData.forEach((calls, index) => {
                    const x = margin.left + index * barWidth;
                    const barHeight = (calls / maxCalls) * chartHeight;
                    
                    // Gradient based on time
                    const isBusinessHours = index >= 8 && index <= 18;
                    ctx.fillStyle = isBusinessHours ? '#f56565' : '#4299e1';
                    
                    ctx.fillRect(x, margin.top + chartHeight - barHeight, barWidth * 0.8, barHeight);
                    
                    // Hour labels (every 3 hours)
                    if (index % 3 === 0) {
                        ctx.fillStyle = '#a0aec0';
                        ctx.font = '7px Inter';
                        ctx.textAlign = 'center';
                        const hour = index === 0 ? '12AM' : index === 12 ? '12PM' : 
                                     index < 12 ? index + 'AM' : (index - 12) + 'PM';
                        ctx.fillText(hour, x + barWidth * 0.4, rect.height - margin.bottom + 12);
                    }
                });
            } catch (error) {
                console.error('Call timeline chart error:', error);
            }
        }

        function createShelterCapChart() {
            const canvas = document.getElementById('shelterCapChart');
            if (!canvas) return;
            
            try {
                const ctx = canvas.getContext('2d');
                const rect = canvas.parentElement.getBoundingClientRect();
                
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                const shelters = [
                    { name: 'Branson', capacity: 95, current: 67 },
                    { name: 'Reeds Spring', capacity: 72, current: 51 },
                    { name: 'Cassville', capacity: 84, current: 59 },
                    { name: 'Anderson', capacity: 65, current: 44 },
                    { name: 'Neosho', capacity: 78, current: 62 }
                ];
                
                const maxCapacity = Math.max(...shelters.map(s => s.capacity));
                const margin = { top: 30, right: 30, bottom: 50, left: 40 };
                const chartWidth = rect.width - margin.left - margin.right;
                const chartHeight = rect.height - margin.top - margin.bottom;
                const barWidth = chartWidth / shelters.length * 0.7;
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                // Grid
                ctx.strokeStyle = '#4a5568';
                ctx.lineWidth = 1;
                for (let i = 0; i <= 5; i++) {
                    const y = margin.top + (chartHeight / 5) * i;
                    ctx.beginPath();
                    ctx.moveTo(margin.left, y);
                    ctx.lineTo(rect.width - margin.right, y);
                    ctx.stroke();
                }
                
                // Draw bars
                shelters.forEach((shelter, index) => {
                    const x = margin.left + index * (chartWidth / shelters.length) + (chartWidth / shelters.length - barWidth) / 2;
                    const capacityHeight = (shelter.capacity / maxCapacity) * chartHeight;
                    const currentHeight = (shelter.current / maxCapacity) * chartHeight;
                    const utilization = shelter.current / shelter.capacity;
                    
                    // Capacity bar
                    ctx.fillStyle = '#4a5568';
                    ctx.fillRect(x, margin.top + chartHeight - capacityHeight, barWidth, capacityHeight);
                    
                    // Current occupancy bar
                    let occupancyColor = '#48bb78';
                    if (utilization > 0.8) occupancyColor = '#f56565';
                    else if (utilization > 0.6) occupancyColor = '#ed8936';
                    
                    ctx.fillStyle = occupancyColor;
                    ctx.fillRect(x, margin.top + chartHeight - currentHeight, barWidth, currentHeight);
                    
                    // Shelter name
                    ctx.fillStyle = '#ffffff';
                    ctx.font = 'bold 8px Inter';
                    ctx.textAlign = 'center';
                    ctx.fillText(shelter.name, x + barWidth / 2, rect.height - margin.bottom + 15);
                    
                    // Percentage
                    ctx.fillStyle = '#ffffff';
                    ctx.font = 'bold 7px Inter';
                    ctx.textAlign = 'center';
                    if (currentHeight > 15) {
                        const percentage = Math.round(utilization * 100);
                        ctx.fillText(percentage + '%', x + barWidth / 2, margin.top + chartHeight - currentHeight / 2 + 2);
                    }
                });
            } catch (error) {
                console.error('Shelter capacity chart error:', error);
            }
        }

        function createOccupancyTrendChart() {
            const canvas = document.getElementById('occupancyTrendChart');
            if (!canvas) return;
            
            try {
                const ctx = canvas.getContext('2d');
                const rect = canvas.parentElement.getBoundingClientRect();
                
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                const trendData = [45.2, 48.7, 52.3, 55.8, 59.1, 57.4, 56.3];
                const maxValue = Math.max(...trendData) + 5;
                const minValue = Math.min(...trendData) - 5;
                const range = maxValue - minValue;
                
                const margin = { top: 10, right: 10, bottom: 20, left: 20 };
                const chartWidth = rect.width - margin.left - margin.right;
                const chartHeight = rect.height - margin.top - margin.bottom;
                const stepX = chartWidth / (trendData.length - 1);
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                // Area fill
                ctx.beginPath();
                trendData.forEach((value, index) => {
                    const x = margin.left + index * stepX;
                    const y = margin.top + chartHeight - ((value - minValue) / range) * chartHeight;
                    if (index === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                });
                ctx.lineTo(margin.left + chartWidth, margin.top + chartHeight);
                ctx.lineTo(margin.left, margin.top + chartHeight);
                ctx.closePath();
                
                ctx.fillStyle = 'rgba(66, 153, 225, 0.2)';
                ctx.fill();
                
                // Line
                ctx.strokeStyle = '#4299e1';
                ctx.lineWidth = 2;
                ctx.beginPath();
                trendData.forEach((value, index) => {
                    const x = margin.left + index * stepX;
                    const y = margin.top + chartHeight - ((value - minValue) / range) * chartHeight;
                    if (index === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                });
                ctx.stroke();
                
                // End point
                const lastValue = trendData[trendData.length - 1];
                const lastX = margin.left + (trendData.length - 1) * stepX;
                const lastY = margin.top + chartHeight - ((lastValue - minValue) / range) * chartHeight;
                
                ctx.fillStyle = '#2d3748';
                ctx.beginPath();
                ctx.arc(lastX, lastY, 3, 0, 2 * Math.PI);
                ctx.fill();
                ctx.strokeStyle = '#4299e1';
                ctx.lineWidth = 2;
                ctx.stroke();
            } catch (error) {
                console.error('Occupancy trend chart error:', error);
            }
        }

        function createShelterMapChart() {
            const canvas = document.getElementById('shelterMapChart');
            if (!canvas) return;
            
            try {
                const ctx = canvas.getContext('2d');
                const rect = canvas.parentElement.getBoundingClientRect();
                
                canvas.width = rect.width;
                canvas.height = rect.height;
                
                ctx.clearRect(0, 0, rect.width, rect.height);
                
                const shelters = [
                    { name: 'Branson', current: 67, capacity: 95, x: 50, y: 60 },
                    { name: 'Reeds Spring', current: 51, capacity: 72, x: 100, y: 55 },
                    { name: 'Cassville', current: 59, capacity: 84, x: 150, y: 70 },
                    { name: 'Anderson', current: 44, capacity: 65, x: 200, y: 65 },
                    { name: 'Neosho', current: 62, capacity: 78, x: 250, y: 50 },
                    { name: 'Mt Vernon', current: 23, capacity: 58, x: 300, y: 75 },
                    { name: 'Harrison', current: 45, capacity: 89, x: 350, y: 110 },
                    { name: 'Berryville', current: 38, capacity: 71, x: 400, y: 105 }
                ];
                
                const margin = { top: 30, right: 30, bottom: 40, left: 30 };
                const mapWidth = rect.width - margin.left - margin.right;
                const mapHeight = rect.height - margin.top - margin.bottom;
                
                // State boundaries
                ctx.strokeStyle = '#4a5568';
                ctx.lineWidth = 2;
                ctx.fillStyle = '#2d3748';
                
                // Missouri
                ctx.beginPath();
                ctx.rect(margin.left, margin.top, mapWidth * 0.6, mapHeight * 0.6);
                ctx.fill();
                ctx.stroke();
                
                // Arkansas
                ctx.beginPath();
                ctx.rect(margin.left + mapWidth * 0.1, margin.top + mapHeight * 0.4, mapWidth * 0.7, mapHeight * 0.5);
                ctx.fill();
                ctx.stroke();
                
                // State labels
                ctx.fillStyle = '#a0aec0';
                ctx.font = 'bold 10px Inter';
                ctx.textAlign = 'center';
                ctx.fillText('MISSOURI', margin.left + mapWidth * 0.3, margin.top + mapHeight * 0.25);
                ctx.fillText('ARKANSAS', margin.left + mapWidth * 0.45, margin.top + mapHeight * 0.7);
                
                // Plot shelters
                shelters.forEach((shelter, index) => {
                    if (index < 8) { // Only plot first 8 to fit in view
                        const x = margin.left + (index % 4) * (mapWidth / 4) + mapWidth / 8;
                        const y = margin.top + Math.floor(index / 4) * (mapHeight / 2) + mapHeight / 4;
                        
                        const utilization = shelter.current / shelter.capacity;
                        let color = '#48bb78'; // Green for available
                        
                        if (utilization > 0.8) {
                            color = '#f56565'; // Red for near full
                        } else if (utilization > 0.6) {
                            color = '#ed8936'; // Orange for limited
                        }
                        
                        // Shelter icon
                        ctx.fillStyle = color;
                        ctx.font = 'bold 12px Inter';
                        ctx.textAlign = 'center';
                        ctx.fillText('⛪', x, y);
                        
                        // Shelter label
                        ctx.fillStyle = '#ffffff';
                        ctx.font = 'bold 6px Inter';
                        ctx.fillText(shelter.name, x, y + 15);
                        
                        // Occupancy info
                        ctx.font = '5px Inter';
                        ctx.fillStyle = '#a0aec0';
                        ctx.fillText(`${shelter.current}/${shelter.capacity}`, x, y + 23);
                    }
                });
                
                // Legend
                const legendX = margin.left;
                const legendY = rect.height - margin.bottom + 15;
                
                ctx.fillStyle = '#48bb78';
                ctx.font = 'bold 8px Inter';
                ctx.fillText('● AVAILABLE', legendX, legendY);
                
                ctx.fillStyle = '#ed8936';
                ctx.fillText('● LIMITED', legendX + 70, legendY);
                
                ctx.fillStyle = '#f56565';
                ctx.fillText('● NEAR FULL', legendX + 130, legendY);
            } catch (error) {
                console.error('Shelter map chart error:', error);
            }
        }

        // Live timestamp updates
        function updateTimestamp() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('en-US', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            const timestampEl = document.getElementById('liveTimestamp');
            if (timestampEl) {
                timestampEl.textContent = timeStr + ' UTC';
            }
        }

        function startLiveUpdates() {
            setInterval(updateTimestamp, 1000);
            
            // Update alert count occasionally
            setInterval(() => {
                const alertEl = document.getElementById('alertCount');
                if (alertEl && Math.random() > 0.8) {
                    const currentCount = parseInt(alertEl.textContent);
                    const change = Math.floor(Math.random() * 3) - 1; // -1, 0, or 1
                    const newCount = Math.max(15, Math.min(30, currentCount + change));
                    alertEl.textContent = newCount.toString();
                }
            }, 10000);
            
            // Simulate live activity updates
            setInterval(() => {
                const feed = document.getElementById('activityFeed');
                if (feed && Math.random() > 0.7) {
                    const activities = [
                        'New damage assessment completed',
                        'Shelter capacity update received',
                        'Emergency call processed',
                        'Field team status update',
                        'Resource shipment arrived',
                        'Financial aid disbursement completed',
                        'Water distribution point activated'
                    ];
                    
                    const priorities = ['high', 'medium', 'low'];
                    const activity = activities[Math.floor(Math.random() * activities.length)];
                    const priority = priorities[Math.floor(Math.random() * priorities.length)];
                    const time = new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false });
                    
                    const newActivity = document.createElement('div');
                    newActivity.className = 'activity-item';
                    newActivity.innerHTML = `
                        <div class="activity-time">${time}</div>
                        <div class="activity-text">${activity}</div>
                        <div class="activity-priority ${priority}">${priority.toUpperCase()}</div>
                    `;
                    
                    feed.insertBefore(newActivity, feed.firstChild);
                    
                    // Remove old activities (keep only 6)
                    while (feed.children.length > 6) {
                        feed.removeChild(feed.lastChild);
                    }
                }
            }, 8000);
        }

        // Utility functions
        function exportData() {
            console.log('📤 Exporting operational data...');
            alert('Export functionality activated - Data would be downloaded in production environment');
        }

        function printReport() {
            console.log('🖨️ Printing report...');
            window.print();
        }

        function refreshData() {
            console.log('🔄 Refreshing all data streams...');
            createAllCharts();
            updateTimestamp();
            
            // Show visual feedback
            const refreshBtns = document.querySelectorAll('.btn.primary');
            refreshBtns.forEach(btn => {
                if (btn.textContent.includes('REFRESH')) {
                    const originalText = btn.textContent;
                    btn.textContent = 'REFRESHED ✓';
                    btn.style.background = '#48bb78';
                    
                    setTimeout(() => {
                        btn.textContent = originalText;
                        btn.style.background = '#990000';
                    }, 2000);
                }
            });
        }

        // Add click handlers for buttons
        document.addEventListener('click', function(e) {
            if (e.target.textContent.includes('EXPORT')) {
                exportData();
            } else if (e.target.textContent.includes('PRINT')) {
                printReport();
            } else if (e.target.textContent.includes('REFRESH')) {
                refreshData();
            }
        });

        // Window resize handler
        window.addEventListener('resize', function() {
            setTimeout(() => {
                createAllCharts();
            }, 100);
        });

        console.log('🚀 Emergency Operations Dashboard JavaScript Loaded Successfully');
    </script>
</body>
</html>